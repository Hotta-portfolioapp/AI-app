<h1><%= @knowhow.title %></h1>

<% if @knowhow.media_files.attached? %>
  <% @knowhow.media_files.each do |file| %>
    <% if file.image? %>
      <%= image_tag url_for(file), width: 400 %>
    <% elsif file.video? %>
      <video width="400" controls>
        <source src="<%= url_for(file) %>" type="<%= file.content_type %>">
      </video>
    <% elsif file.audio? %>
      <audio controls>
        <source src="<%= url_for(file) %>" type="<%= file.content_type %>">
      </audio>
    <% end %>
  <% end %>
<% end %>

<p><%= @knowhow.description %></p>
<p>価格: ¥<%= @knowhow.price %></p>
<p>投稿者: <%= @knowhow.user.email %></p>

<% if @purchased && @purchase.chat_room.present? %>
  <%= link_to "チャットへ", knowhow_chat_room_path(@knowhow, @purchase.chat_room) %>
<% else %>
  <%= link_to "購入する", new_knowhow_purchase_path(@knowhow) %>
<% end %>

<% if @knowhow.user == current_user %>
  <%= link_to '編集', edit_knowhow_path(@knowhow) %>
  <%= link_to '削除', knowhow_path(@knowhow),
            data: { turbo_method: :delete, turbo_confirm: '本当に削除しますか？' } %>
<% end %>
